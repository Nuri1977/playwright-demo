/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
'use strict';var k=function(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(g){g.done?d(g.value):Promise.resolve(g.value).then(b,c).then(f,e)}f(a.next())})},m=this||self,aa=function(a,b,c){return a.call.apply(a.bind,arguments)},ba=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,
e)}}return function(){return a.apply(b,arguments)}},n=function(a,b,c){n=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba;return n.apply(null,arguments)},ca=function(a,b){function c(){}c.prototype=b.prototype;a.nb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(d,e,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[e].apply(d,g)}};var da="getAccounts hello getLogBuffer recordLog getQuirks updateQuirks uiEvent".split(" ");var ka=function(a){switch(a){case ea.name:return ea;case fa.name:return fa;case p.name:return p;case ha.name:return ha;case ia.name:return ia;default:let b=ja.get(a);b||(b=new q(a),ja.set(a,b));return b}},q=class{constructor(a){this.name=a}toString(){return this.name}},ja=new Map,ea=new q("async"),fa=new q("generic"),p=new q("runtime"),ha=new q("system"),ia=new q("crypto"),r=class extends Error{constructor(a,b,c){super(c);this.code=a;this.category=b;Object.setPrototypeOf(this,new.target.prototype)}toString(){return`${this.category}:${this.code} (${this.message||
"Undefined error."})`}};var la=class{constructor(){let a=void 0,b=void 0;this.promise=new Promise((c,d)=>{a=c;b=d});this.resolve=a;this.reject=b}},ma=class extends r{constructor(a,b="One or more errors occurred."){super(1,ea,b);this.errors=a;Object.setPrototypeOf(this,new.target.prototype)}flatten(){const a=[],b=[this.errors.slice(0)];for(;0!==b.length;){const c=b[0];for(;0!==c.length;){const d=c.shift();if(d instanceof ma){b.unshift(d.errors.slice(0));break}else a.push(d)}b[0]===c&&b.shift()}return new ma(a,this.message)}};var na=class{constructor(){this.F=[]}subscribe(a){this.F.push(a)}unsubscribe(a){a=this.F.indexOf(a);if(-1===a)return!1;this.F.splice(a,1);return!0}publish(a){const b=[],c=this.F.slice(0);for(const d of c)b.push(d(a));return b}};function t(a,b){if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{const c=Error().stack;c&&(this.stack=c)}a&&(this.message=String(a));void 0!==b&&(this.cause=b)}ca(t,Error);t.prototype.name="CustomError";var u=function(){this.Da=Date.now()},oa=null;u.prototype.set=function(a){this.Da=a};u.prototype.reset=function(){this.set(Date.now())};u.prototype.get=function(){return this.Da};var pa=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]},qa=function(a,b){return a<b?-1:a>b?1:0};var w=class{constructor(a,b){this.ia=b===v?a:""}toString(){return this.ia.toString()}};w.prototype.Va=!0;var ra=function(a){return a instanceof w&&a.constructor===w?a.ia:"type_error:SafeUrl"},sa=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,ta=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,v={},ua=new w("about:invalid#zClosurez",v);a:for(var va=["CLOSURE_FLAGS"],wa=m,xa=0;xa<va.length;xa++)if(wa=wa[va[xa]],null==wa)break a;function ya(){var a=m.navigator;return a&&(a=a.userAgent)?a:""}var x;const za=m.navigator;x=za?za.userAgentData||null:null;function Aa(a){return x?x.brands.some(({brand:b})=>b&&-1!=b.indexOf(a)):!1}function y(a){return-1!=ya().indexOf(a)};var Ba=class{constructor(a){this.jb=a}};var Ca=new class{constructor(a){this.ya=a;this.ja=this.na=void 0;this.Aa=!1}fa(){if(x)return this.na}load(){const a=this;return k(function*(){if(x)return a.ja||(a.Aa=!0,a.ja=(()=>k(function*(){try{const b=yield x.getHighEntropyValues([a.ya]);a.na=b[a.ya];return a.na}finally{a.Aa=!1}}()))()),yield a.ja}())}}("fullVersionList");function z(){return!!x&&0<x.brands.length}function Da(){return z()?!1:y("Opera")}function Ea(){return z()?!1:y("Trident")||y("MSIE")}function A(){return z()?!1:y("Edge")}function B(){return z()?Aa("Microsoft Edge"):y("Edg/")}function Fa(){return z()?Aa("Opera"):y("OPR")}function C(){return y("Firefox")||y("FxiOS")}function D(){return z()?Aa("Chromium"):(y("Chrome")||y("CriOS"))&&!A()||y("Silk")}function Ga(a){const b={};a.forEach(c=>{b[c[0]]=c[1]});return c=>b[c.find(d=>d in b)]||""}
function Ha(a){var b=ya();if("Internet Explorer"===a){if(Ea())if((a=/rv: *([\d\.]*)/.exec(b))&&a[1])b=a[1];else{a="";var c=/MSIE +([\d\.]+)/.exec(b);if(c&&c[1])if(b=/Trident\/(\d.\d)/.exec(b),"7.0"==c[1])if(b&&b[1])switch(b[1]){case "4.0":a="8.0";break;case "5.0":a="9.0";break;case "6.0":a="10.0";break;case "7.0":a="11.0"}else a="7.0";else a=c[1];b=a}else b="";return b}const d=RegExp("([A-Z][\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g");c=[];let e;for(;e=d.exec(b);)c.push([e[1],e[2],e[3]||void 0]);
b=Ga(c);switch(a){case "Opera":if(Da())return b(["Version","Opera"]);if(Fa())return b(["OPR"]);break;case "Microsoft Edge":if(A())return b(["Edge"]);if(B())return b(["Edg"]);break;case "Chromium":if(D())return b(["Chrome","CriOS","HeadlessChrome"])}return"Firefox"===a&&C()||"Safari"===a&&y("Safari")&&!(D()||(z()?0:y("Coast"))||Da()||A()||B()||Fa()||C()||y("Silk")||y("Android"))||"Android Browser"===a&&y("Android")&&!(D()||C()||Da()||y("Silk"))||"Silk"===a&&y("Silk")?(b=c[2])&&b[1]||"":""}
function Ia(){if(z()){var a=x.brands.find(({brand:b})=>"Chromium"===b);if(!a||!a.version)return NaN;a=a.version.split(".")}else{a=Ha("Chromium");if(""===a)return NaN;a=a.split(".")}return 0===a.length?NaN:Number(a[0])}
class Ja{constructor(a,b,c){this.sa=a;this.La=new Ba(c);this.Ka=b}fa(){if(this.Ka){var a=Ca.fa();if(void 0!==a)return a=a.find(({brand:b})=>this.sa===b),new Ba(a.version)}if(Ka)return this.La}load(){const a=this;return k(function*(){if(a.Ka){var b=yield Ca.load();if(void 0!==b)return b=b.find(({brand:c})=>a.sa===c),new Ba(b.version)}else yield 0;Ka=!0;return a.La}())}}let Ka=!1;function La(){return k(function*(){z()&&(yield Ca.load());Ka=!0}())}
function Ma(a){let b="";98<=Ia()||(b=Ha(a));const c="Silk"!==a&&z();if(c){if(!x.brands.find(({brand:d})=>d===a))return}else if(""===b)return;return new Ja(a,c,b)}function Na(a){if(z()){var b=Ma(a);return b?(b=b.fa())?b.jb:x.brands.find(({brand:c})=>c===a).version:""}return Ha(a)};var E=class{constructor(a,b){this.name=a;this.value=b}toString(){return this.name}},F=new E("OFF",Infinity),Oa=new E("SEVERE",1E3),Pa=new E("WARNING",900),Qa=new E("INFO",800),Ra=new E("CONFIG",700),Sa=new E("ALL",0),G=[F,new E("SHOUT",1200),Oa,Pa,Qa,Ra,new E("FINE",500),new E("FINER",400),new E("FINEST",300),Sa],H=null,Ta=function(a){if(!H){H={};for(let b=0,c;c=G[b];b++)H[c.value]=c,H[c.name]=c}if(a in H)return H[a];for(let b=0;b<G.length;++b){let c=G[b];if(c.value<=a)return c}return null},Ua=class{constructor(){this.X=
0;this.clear()}clear(){this.ta=Array(this.X);this.va=-1;this.xa=!1}},Va,Xa=class{constructor(a,b,c){this.Y=void 0;this.reset(a||F,b,c,void 0,void 0)}reset(a,b,c,d,e){this.ma=d||Date.now();this.ba=a;this.Xa=b;this.ga=c;this.Y=void 0;this.ab="number"===typeof e?e:Wa}getMessage(){return this.Xa}},Wa=0,Ya=function(a){return a.level?a.level:a.parent?Ya(a.parent):F},Za=class{constructor(a,b=null){this.level=null;this.F=[];this.parent=b||null;this.children=[];this.za={J:()=>a}}publish(a){let b=this;for(;b;)b.F.forEach(c=>
{c(a)}),b=b.parent}},I=function(a,b){var c=a.entries[b];if(c)return c;c=I(a,b.slice(0,Math.max(b.lastIndexOf("."),0)));const d=new Za(b,c);a.entries[b]=d;c.children.push(d);return d},$a=class{constructor(){this.entries={};const a=new Za("");a.level=Ra;this.entries[""]=a}},ab,J=function(){ab||(ab=new $a);return ab},cb=function(a){var b=bb;b&&I(J(),b.J()).F.push(a)},db=function(a){var b=bb;b&&(I(J(),b.J()).level=a)},eb=function(){var a=bb;return a?I(J(),a.J()).level:null},K=function(a,b,c){var d;if(d=
a)if(d=a&&b){d=b.value;var e=a?Ya(I(J(),a.J())):F;d=d>=e.value}if(d){b=b||F;d=I(J(),a.J());"function"===typeof c&&(c=c());Va||(Va=new Ua);e=Va;a=a.J();if(0<e.X){var f=(e.va+1)%e.X;e.va=f;e.xa?(e=e.ta[f],e.reset(b,c,a),a=e):(e.xa=f==e.X-1,a=e.ta[f]=new Xa(b,c,a))}else a=new Xa(b,c,a);a.Y=void 0;d.publish(a)}};var M=function(a){this.Ya=a||"";oa||(oa=new u);this.cb=oa};M.prototype.ra=!0;M.prototype.ka=!0;M.prototype.Ga=!0;M.prototype.bb=!0;M.prototype.Fa=!1;M.prototype.Ha=!1;var N=function(a){return 10>a?"0"+a:String(a)},fb=function(a){M.call(this,a)};ca(fb,M);
var gb=function(a,b){var c=[];c.push(a.Ya," ");if(a.ka){var d=new Date(b.ma);c.push("[",N(d.getFullYear()-2E3)+N(d.getMonth()+1)+N(d.getDate())+" "+N(d.getHours())+":"+N(d.getMinutes())+":"+N(d.getSeconds())+"."+N(Math.floor(d.getMilliseconds()/10)),"] ")}if(a.Ga){d=c.push;var e=a.cb.get();e=(b.ma-e)/1E3;var f=e.toFixed(3),g=0;if(1>e)g=2;else for(;100>e;)g++,e*=10;for(;0<g--;)f=" "+f;d.call(c,"[",f,"s] ")}a.bb&&c.push("[",b.ga,"] ");a.Ha&&c.push("[",b.ba.name,"] ");c.push(b.getMessage());a.Fa&&(b=
b.Y,void 0!==b&&c.push("\n",b instanceof Error?b.message:String(b)));a.ra&&c.push("\n");return c.join("")};function hb(a=new fb){a.ka=!0;a.Ga=!1;a.Ha=!0}var kb=class{constructor(a){this.target=I(J(),a).za}log(a,b){K(this.target,null!=a?a:ib,b)}error(a){K(this.target,Oa,a)}warn(a){K(this.target,Pa,a)}info(a){K(this.target,Qa,a)}debug(a){K(this.target,ib,a)}trace(a){K(this.target,jb,a)}},bb=I(J(),"").za,ib=new E("DEBUG",600),jb=new E("TRACE",100);G.push(ib);G.push(jb);function lb(a){switch(a.type){case 0:return a.object;case 1:return Error(a.message);case 2:return new r(a.code,ka(a.category),a.message);case 3:return new ma(a.errors.map(lb),a.message)}};var mb=function(a,...b){return k(function*(){const c=new la;chrome.runtime.sendMessage({method:a,args:b},d=>{const e=chrome.runtime.lastError;e?c.reject(new r(1,p,`Operation '${String(a)}' failed. ${e.message||"Undefined error."}`)):d.error?c.reject(lb(d.error)):c.resolve(d.output)});return c.promise}())},nb=function(a){for(const [c,d]of a.Ba){const e=c;var b=d;if(da.every(f=>e.has(f)))return b}b={};for(const c of da)Object.defineProperty(b,c,{value:(...d)=>mb(c,...d),writable:!1});a.Ba.set(new Set(da),
b);return b},O=function(a,b){let c=a.events.get(b);if(!c){const d=chrome.runtime.connect({name:b});c={port:d,source:new na,Ca:[]};d.onMessage.addListener(e=>{e=null===e?void 0:e;const f=c.Ca.shift();f?f.resolve(e):c.source.publish(e)});a.events.set(b,c)}return c},P=function(a,b){a=O(a,b);b=new la;a.Ca.push(b);a.port.postMessage({});return b.promise},ob=class{constructor(){this.events=new Map;this.Ba=new Map}};let pb=void 0;function qb(a){if(pb)throw new r(416,fa,"Runtime Info has already been initialized.");pb=a};var rb=function(){};function sb(){return k(function*(){return new Promise((a,b)=>{chrome.runtime.getPlatformInfo(c=>{const d=chrome.runtime.lastError;d&&b(new r(1,p,d.message||"Call to c.r.getPlatformInfo failed."));a(c)})})}())}function tb(a){switch(a){case "mac":return 1;case "win":return 2;case "cros":return 4;case "linux":return 3;default:return 0}}function ub(){switch(D()?B()?2:Fa()?4:1:C()?3:0){case 2:return"Microsoft Edge";case 1:return"Chromium";case 3:return"Firefox";case 4:return"Opera"}}
function vb(){return k(function*(){const a=ub();return a?(yield La(),Na(a)):""}())}
function wb(){return k(function*(){var a=yield sb();a=tb(a.os);const b=yield vb();return{ha:a,Ua:{browser:D()?B()?2:Fa()?4:1:C()?3:0,version:b,lb:c=>{let d=0;const e=pa(String(b)).split(".");c=pa(String(c)).split(".");const f=Math.max(e.length,c.length);for(let l=0;0==d&&l<f;l++){var g=e[l]||"",h=c[l]||"";do{g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];h=/(\d*)(\D*)(.*)/.exec(h)||["","","",""];if(0==g[0].length&&0==h[0].length)break;d=qa(0==g[1].length?0:parseInt(g[1],10),0==h[1].length?0:parseInt(h[1],
10))||qa(0==g[2].length,0==h[2].length)||qa(g[2],h[2]);g=g[3];h=h[3]}while(0==d)}return 0<=d}},mb:{version:chrome.runtime.getManifest().version}}}())};function xb(a,b=`unexpected value ${a}!`){throw Error(b);};/*

 SPDX-License-Identifier: Apache-2.0
*/
var yb;try{new URL("s://g"),yb=!0}catch(a){yb=!1}const zb=yb;function Ab(a,b){if(b instanceof w)b=ra(b);else{b:if(zb){try{var c=new URL(b)}catch(d){c="https:";break b}c=c.protocol}else c:{c=document.createElement("a");try{c.href=b}catch(d){c=void 0;break c}c=c.protocol;c=":"===c||""===c?"https:":c}b="javascript:"!==c?b:void 0}void 0!==b&&(a.href=b)};class Bb{constructor(a){this.isValid=a}}function Q(a){return new Bb(b=>b.substr(0,a.length+1).toLowerCase()===a+":")}const Cb=[Q("data"),Q("http"),Q("https"),Q("mailto"),Q("ftp"),new Bb(a=>/^[^:]*([/?#]|$)/.test(a))];function Db(a){for(let b=0;b<Cb.length;++b){const c=Cb[b];if(c instanceof Bb&&c.isValid(a))return new w(a,v)}};function Eb(a){switch(a.ha){case 2:return"https://dl.google.com/tag/s/appguid=%7B5289EAA4-96AA-881C-BCCA-C3A9D2D95347%7D&appname=SecureConnect-Win&needsadmin=false/secureconnect/install/win/regular/EndpointVerification.exe";case 1:return"https://dl.google.com/dl/secureconnect/install/mac/EndpointVerification.dmg";case 3:return"https://support.google.com/a/users/answer/9018161?hl=en#linuxhelper";default:return"#"}}
function R(a,b,c){b=`[${"data-template-id"}='${b}']`;return a.querySelector(void 0!==c?b+`[${"data-variation"}='${c}']`:b+":not([data-variation])")}function S(a,b,c="element"){b=`[${"data-part"}='${b}']`;"element"!==c&&(b=`${c}${b}`);return a.querySelector(b)}function T(a,b="element"){var c=document;a=`#${a}`;"element"!==b&&(a=`${b}${a}`);return c.querySelector(a)}
function U(a,b){a=a.classList;void 0!==b.visible&&a.toggle("invisible",!b.visible);void 0!==b.display&&a.toggle("hidden",!b.display);void 0!==b.active&&a.toggle("is-active",b.active)}function Fb(a){for(;a.firstChild;)a.removeChild(a.firstChild)}const V=new kb("PopupPresenter");
var Gb=function(a){k(function*(){a.la.disabled=!0;try{yield a.background.uiEvent({event:"Sync Button Click"})}catch(b){V.warn(`Failed to send '${"Sync Button Click"}' event notification. ${b.message}`)}finally{a.la.disabled=!1}}())},Hb=function(a){k(function*(){a.S.disabled=!0;try{yield a.background.uiEvent({event:"VPN Button Click"})}catch(b){V.warn(`Failed to send '${"VPN Button Click"}' UI notification. ${b.message}`)}finally{a.S.disabled=!1}}())},Ib=function(a,b){U(a.fb,{active:b})},Kb=function(a,
b){var c=0!==b;let d=R(a.U,"sync-banner");d&&!c?d.remove():c&&(d||(d=a.eb.cloneNode(!0),a.U.prepend(d)),c=S(d,"error-content","span"),Fb(c),a=Jb(a,b),null!==a&&"string"===typeof a?c.textContent=a:c.append(a))},Pb=function(a,b){V.trace(()=>`Updating state using ${JSON.stringify(b)}.`);var c=b.items,d=c.filter(g=>g.isManaged);a.V=d.some(g=>g.isEnabledForVpn);Lb(a);if(0===d.length){Fb(a.wa);U(a.Ia,{display:!1});U(a.R,{display:!0});U(a.Qa,{display:0!==c.length});d=Math.min(c.length,4);for(var e=0;e<d;++e)a.wa.append(Mb(a,
c[e]))}else{U(a.Ia,{display:!0});U(a.R,{display:!1});U(a.pa,{display:!0});U(a.Ma,{display:!1});c=new Set(a.v.keys());var f=new Set(d.map(g=>g.id));for(e of d){let g=a.v.get(e.id);g||(g=Nb(a,e),a.v.set(e.id,g),a.pa.append(g));Ob(a,g,e,1<d.length)}for(const g of c)f.has(g)||(a.v.get(g).remove(),a.v.delete(g));d=Math.min(...d.map(g=>{let h;return null!=(h=g.syncTimestamp)?h:0}));d=0!==d?`${chrome.i18n.getMessage("last_sync_date")}: ${(new Date(d)).toLocaleString()}`:chrome.i18n.getMessage("no_sync_date");
a.gb.textContent=d||"PLACEHOLDER";componentHandler.upgradeDom()}},Sb=function(a,b){V.trace(()=>`Selected Account: '${b}'.`);a.B!==b&&(Qb(a,a.B,!1),Rb(a,a.B,!1),a.B=b,Qb(a,a.B,1===a.o),Rb(a,a.B,!0))},Ub=function(a,b){V.trace(()=>`VPN state: ${b}.`);a.o=b;const c=1===a.o;0!==a.o&&(a.oa=void 0);Qb(a,a.B,c);Tb(a);Lb(a)},Vb=function(a,b){V.trace(()=>`VPN error: ${b}.`);void 0!==b&&(a.oa=b,Lb(a))},Jb=function(a,b){switch(b){case 0:return"";case 99:return a.getMessage("sync_error_text");case 2:return b=
R(a.H,"error-content",`native-messaging:${1===a.runtime.Ua.browser?"chrome":"generic"}`).cloneNode(!0),Ab(S(b,"download-link","a"),Db(Eb(a.runtime))),b;case 4:return a.getMessage("data_integrity_error_text");case 3:b=a.getMessage("data_protection_key_error_text");a:switch(a.runtime.ha){case 2:var c="https://support.google.com/a?p=ev_data_key_troubleshooting_win";break a;case 1:c="https://support.google.com/a?p=ev_data_key_troubleshooting_osx";break a;default:c="https://support.google.com/a?p=ev_troubleshooting"}return Wb(a,
b,c);case 11:return Wb(a,a.getMessage("dpapi_failure_error_text"),"https://support.google.com/a?p=ev_dpapi_troubleshooting");case 21:return Wb(a,a.getMessage("keychain_auth_error_text"),"https://support.google.com/a?p=ev_keychain_troubleshooting");case 22:return a.getMessage("keychain_locked_error_text");case 1:return a.getMessage("admin_install_required_text");case 32:return a.getMessage("platform_keys_inaccesible_text");default:xb(b,void 0)}},Qb=function(a,b,c){b&&(a=a.v.get(b))&&U(S(S(a,"avatar"),
"spinner"),{active:c,display:c})},Rb=function(a,b,c){b&&(a=a.v.get(b))&&(S(a,"account-selector","input").checked=c)},Tb=function(a){const b=2===a.o,c=0===a.o;for(const [d,e]of a.v){const f=e,g=d===a.B,h=S(f,"account-selector","input");h.checked=g;U(h,{display:c&&1<a.v.size});U(S(f,"connection-indicator"),{display:b&&g})}},Lb=function(a){k(function*(){const b=0===a.o;var c=void 0!==a.oa;let d=R(a.U,"vpn-banner");d&&!a.V&&(c||d.remove());if(a.V||c){d||(d=a.kb.cloneNode(!0),a.U.append(d));let e="null";
if(c){e="error";c=S(d,"error-content","span");Fb(c);const f=Xb(a,a.oa);null!==f&&"string"===typeof f?c.textContent=f:c.append(f);try{yield a.background.uiEvent({event:"VPN Error Shown"})}catch(g){V.warn(`Failed to send '${"VPN Error Shown"}' UI notification. ${g.message}`)}}else switch(a.o){case 0:e="disconnected";break;case 1:e="connecting";break;case 2:e="connected";break;default:xb(a.o,void 0)}d.setAttribute("data-active-item",e)}U(a.S,{display:!b||a.V});a.S.setAttribute("data-active-item",b?"connect":
"disconnect")}())},Mb=function(a,b){a=a.Oa.cloneNode(!0);S(a,"email","span").textContent=b.email;return a},Nb=function(a,b){const c=a.Na.cloneNode(!0);c.id=`account-${b.id}`;S(c,"account-selector","input").addEventListener("click",()=>{Yb(a,b.id);return!1});return c},Ob=function(a,b,c,d){c.isEnabledForVpn?b.setAttribute("data-vpn-enabled",""):b.removeAttribute("data-vpn-enabled");var e=S(b,"picture","img");var f=c.photoUrl;f instanceof w||(f="object"==typeof f&&f.Va?f.ia.toString():String(f),ta.test(f)?
f=new w(f,v):(f=String(f).replace(/(%0A|%0D)/g,""),f=f.match(sa)?new w(f,v):null));e.src=ra(f||ua);S(b,"display-name","span").textContent=c.displayName;S(b,"email","span").textContent=c.email;c=c.id===a.B;e=2===a.o;a=0===a.o;f=S(b,"account-selector","input");f.checked=c;U(f,{display:a&&d});U(S(b,"connection-indicator"),{display:c&&e})},Xb=function(a,b){switch(b){case 1:case 8:b=R(a.H,"error-content","native-messaging:generic").cloneNode(!0);a:switch(a.runtime.ha){case 2:a="https://dl.google.com/dl/secureconnect/install/win/admin_helper/BCEClientConnector.msi";
break a;case 1:a="https://dl.google.com/dl/secureconnect/install/mac/admin_helper/BCEClientConnector.dmg";break a;default:a="https://cloud.google.com/beyondcorp-enterprise/"}Ab(S(b,"download-link","a"),Db(a));return b;case 2:return a.getMessage("get_auth_token_error_text");case 3:return a.getMessage("vpn_auth_verification_failed_text");case 4:return a.getMessage("vpn_connection_timed_out_text");case 5:return a.getMessage("vpn_connection_reset_text");case 6:return a.getMessage("vpn_connection_tls_error_text");
case 7:return a.getMessage("vpn_adapter_error_text");case 10:return a.getMessage("vpn_network_not_available_text");default:return a.getMessage("vpn_generic_error_text")}},Yb=function(a,b){k(function*(){try{yield a.background.uiEvent({event:"Account Selector Click",accountId:b})}catch(c){V.warn(`Failed to send '${"Account Selector Click"}' UI notification. ${c.message}`)}}())},Wb=function(a,b,c){a=a.Ra.cloneNode(!0);S(a,"text","span").textContent=b;Ab(S(a,"help-link","a"),Db(c));return a},$b=class{constructor(a){var b=
Zb;this.g=b;this.runtime=a;this.v=new Map;this.V=!1;this.o=0;this.background=nb(b);this.H=T("templates");this.eb=R(this.H,"sync-banner");this.kb=R(this.H,"vpn-banner");this.Ra=R(this.H,"error-content","text_and_help_link");this.Na=R(this.H,"account");this.Oa=R(this.H,"account-tooltip");this.R=T("signin-view");this.Qa=S(this.R,"disabled-accounts");this.wa=S(this.R,"account-list");this.U=T("banners");a=T("accounts");this.Ma=S(a,"load-indicator");this.pa=S(a,"account-list");this.S=T("vpn-button","button");
this.Ia=T("sync-view");this.gb=S(T("sync-status"),"content","span");this.la=T("sync-button","button");this.fb=T("sync-spinner");a=document.querySelectorAll("[data-requires-sku]:not([data-requires-sku=external])");for(const c of a)c.remove()}initialize(){const a=this;return k(function*(){S(a.R,"add-account","button").onclick=()=>{chrome.tabs.create({url:"https://accounts.google.com/addsession"})};a.la.onclick=()=>{Gb(a)};a.S.onclick=()=>{Hb(a)};O(a.g,"sync/inProgress:change").source.subscribe(c=>{Ib(a,
c)});Ib(a,yield P(a.g,"sync/inProgress:change"));O(a.g,"sync:completion").source.subscribe(c=>{Kb(a,c)});Kb(a,yield P(a.g,"sync:completion"));O(a.g,"accounts:update").source.subscribe(c=>{Pb(a,c)});var b=yield P(a.g,"accounts:update");if(!b)try{b=yield a.background.getAccounts()}catch(c){V.warn(`Failed to retrieve accounts. ${c.message}`)}b&&Pb(a,b);O(a.g,"accounts/selectedId:change").source.subscribe(c=>{Sb(a,c)});Sb(a,yield P(a.g,"accounts/selectedId:change"));O(a.g,"vpn/state:change").source.subscribe(c=>
{Ub(a,c)});Ub(a,yield P(a.g,"vpn/state:change"));O(a.g,"vpn/error:change").source.subscribe(c=>{Vb(a,c)});Vb(a,yield P(a.g,"vpn/error:change"));b=document.querySelectorAll("[data-i18n]");for(const c of b)b=c.getAttribute("data-i18n"),c.textContent=chrome.i18n.getMessage(b)||chrome.i18n.getMessage(`${b}_${"external"}`)||"PLACEHOLDER"}())}getMessage(a){const b=chrome.i18n?chrome.i18n.getMessage(a):"";return void 0===b?(V.warn(`i18n key '${a}' not found.`),"PLACEHOLDER"):b}};var ac=function(){n(this.qa,this);this.O=new fb;this.O.ka=!1;this.O.Fa=!1;this.O.ra=!1;this.Ta={}};ac.prototype.qa=function(a){function b(f){if(f){if(f.value>=Oa.value)return"error";if(f.value>=Pa.value)return"warn";if(f.value>=Ra.value)return"log"}return"debug"}if(!this.Ta[a.ga]){var c=gb(this.O,a),d=bc;if(d){var e=b(a.ba);cc(d,e,c,a.Y)}}};var bc=m.console,cc=function(a,b,c,d){if(a[b])a[b](c,void 0===d?"":d);else a.log(c,void 0===d?"":d)};class dc{constructor(a,b){this.Wa=100;this.Pa=a;this.Za=b;this.ca=0;this.aa=null}get(){let a;0<this.ca?(this.ca--,a=this.aa,this.aa=a.next,a.next=null):a=this.Pa();return a}put(a){this.Za(a);this.ca<this.Wa&&(this.ca++,a.next=this.aa,this.aa=a)}};var ec=function(){var a=document;var b="IFRAME";"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)};var fc,gc=function(){var a=m.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(a=function(){var e=ec();e.style.display="none";document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=n(function(l){if(("*"==h||l.origin==h)&&l.data==g)this.port1.onmessage()},this);f.addEventListener("message",
e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!Ea()){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.ua;c.ua=null;e()}};return function(e){d.next={ua:e};d=d.next;b.port2.postMessage(0)}}return function(e){m.setTimeout(e,0)}};function hc(a){m.setTimeout(()=>{throw a;},0)};class ic{constructor(){this.da=this.N=null}add(a,b){const c=jc.get();c.set(a,b);this.da?this.da.next=c:this.N=c;this.da=c}remove(){let a=null;this.N&&(a=this.N,this.N=this.N.next,this.N||(this.da=null),a.next=null);return a}}var jc=new dc(()=>new kc,a=>a.reset());class kc{constructor(){this.next=this.scope=this.fn=null}set(a,b){this.fn=a;this.scope=b;this.next=null}reset(){this.next=this.scope=this.fn=null}};let lc,mc=!1,nc=new ic,pc=(a,b)=>{lc||oc();mc||(lc(),mc=!0);nc.add(a,b)},oc=()=>{if(m.Promise&&m.Promise.resolve){const a=m.Promise.resolve(void 0);lc=()=>{a.then(qc)}}else lc=()=>{var a=qc;"function"!==typeof m.setImmediate||m.Window&&m.Window.prototype&&!A()&&m.Window.prototype.setImmediate==m.setImmediate?(fc||(fc=gc()),fc(a)):m.setImmediate(a)}};var qc=()=>{let a;for(;a=nc.remove();){try{a.fn.call(a.scope)}catch(b){hc(b)}jc.put(a)}mc=!1};var X=function(a){this.j=0;this.Ea=void 0;this.I=this.A=this.G=null;this.Z=this.ea=!1;if(a!=rb)try{var b=this;a.call(void 0,function(c){W(b,2,c)},function(c){W(b,3,c)})}catch(c){W(this,3,c)}},rc=function(){this.next=this.context=this.K=this.P=this.C=null;this.T=!1};rc.prototype.reset=function(){this.context=this.K=this.P=this.C=null;this.T=!1};var sc=new dc(function(){return new rc},function(a){a.reset()}),tc=function(a,b,c){var d=sc.get();d.P=a;d.K=b;d.context=c;return d};
X.prototype.then=function(a,b,c){return uc(this,"function"===typeof a?a:null,"function"===typeof b?b:null,c)};X.prototype.$goog_Thenable=!0;X.prototype.Ja=function(a,b){return uc(this,null,a,b)};X.prototype.catch=X.prototype.Ja;X.prototype.cancel=function(a){if(0==this.j){var b=new Y(a);pc(function(){vc(this,b)},this)}};
var vc=function(a,b){if(0==a.j)if(a.G){var c=a.G;if(c.A){for(var d=0,e=null,f=null,g=c.A;g&&(g.T||(d++,g.C==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.j&&1==d?vc(c,b):(f?(d=f,d.next==c.I&&(c.I=d),d.next=d.next.next):wc(c),xc(c,e,3,b)))}a.G=null}else W(a,3,b)},zc=function(a,b){a.A||2!=a.j&&3!=a.j||yc(a);a.I?a.I.next=b:a.A=b;a.I=b},uc=function(a,b,c,d){var e=tc(null,null,null);e.C=new X(function(f,g){e.P=b?function(h){try{var l=b.call(d,h);f(l)}catch(L){g(L)}}:f;e.K=c?function(h){try{var l=c.call(d,
h);void 0===l&&h instanceof Y?g(h):f(l)}catch(L){g(L)}}:g});e.C.G=a;zc(a,e);return e.C};X.prototype.hb=function(a){this.j=0;W(this,2,a)};X.prototype.ib=function(a){this.j=0;W(this,3,a)};
var W=function(a,b,c){if(0==a.j){a===c&&(b=3,c=new TypeError("Promise cannot resolve to itself"));a.j=1;a:{var d=c,e=a.hb,f=a.ib;if(d instanceof X){zc(d,tc(e||rb,f||null,a));var g=!0}else{if(d)try{var h=!!d.$goog_Thenable}catch(L){h=!1}else h=!1;if(h)d.then(e,f,a),g=!0;else{h=typeof d;if("object"==h&&null!=d||"function"==h)try{var l=d.then;if("function"===typeof l){Ac(d,l,e,f,a);g=!0;break a}}catch(L){f.call(a,L);g=!0;break a}g=!1}}}g||(a.Ea=c,a.j=b,a.G=null,yc(a),3!=b||c instanceof Y||Bc(a,c))}},
Ac=function(a,b,c,d,e){var f=!1,g=function(l){f||(f=!0,c.call(e,l))},h=function(l){f||(f=!0,d.call(e,l))};try{b.call(a,g,h)}catch(l){h(l)}},yc=function(a){a.ea||(a.ea=!0,pc(a.Sa,a))},wc=function(a){var b=null;a.A&&(b=a.A,a.A=b.next,b.next=null);a.A||(a.I=null);return b};X.prototype.Sa=function(){for(var a;a=wc(this);)xc(this,a,this.j,this.Ea);this.ea=!1};
var xc=function(a,b,c,d){if(3==c&&b.K&&!b.T)for(;a&&a.Z;a=a.G)a.Z=!1;if(b.C)b.C.G=null,Cc(b,c,d);else try{b.T?b.P.call(b.context):Cc(b,c,d)}catch(e){Dc.call(null,e)}sc.put(b)},Cc=function(a,b,c){2==b?a.P.call(a.context,c):a.K&&a.K.call(a.context,c)},Bc=function(a,b){a.Z=!0;pc(function(){a.Z&&Dc.call(null,b)})},Dc=hc,Y=function(a){t.call(this,a)};ca(Y,t);Y.prototype.name="cancel";var Ec=function(a,b){if("function"!==typeof a)if(a&&"function"==typeof a.handleEvent)a=n(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:m.setTimeout(a,b||0)},Fc=function(a){var b=null;return(new X(function(c,d){b=Ec(function(){c(void 0)},a);-1==b&&d(Error("Failed to schedule timer."))})).Ja(function(c){m.clearTimeout(b);throw c;})};const Zb=new ob,Gc=nb(Zb);(function(){db(Sa);const a=new ac;hb(a.O);cb(c=>{const d=c.ba;d&&d.value>=Pa.value&&a.qa(c)});let b=!1;cb(c=>{if(!b){b=!0;try{var d=Gc.recordLog;var e={t:c.ma,l:c.ba.value,m:c.getMessage(),n:c.ga,s:c.ab};d.call(Gc,e)}catch(f){}finally{b=!1}}})})();const Z=new kb("Popup Script");
function Hc(){k(function*(){Z.debug("Initializing...");const a=yield wb();qb(a);for(var b=1;10>=b;++b)try{yield Gc.hello();break}catch(d){const e=d;if(10<=b)throw Z.error(`Failed to communicate with background page after ${b} attempts. ${e.message}`),e;yield Fc(100+(15<<b))}b=yield P(Zb,"log/level:change");b=Ta(b);db(b);let c;Z.warn(`Log level is set to ${null==(c=eb())?void 0:c.name}.`);O(Zb,"log/level:change").source.subscribe(d=>{d=Ta(d);db(d);let e;Z.warn(`Log level is set to ${null==(e=eb())?
void 0:e.name}.`)});try{yield Gc.uiEvent({event:"Popup Load"})}catch(d){Z.warn(`Failed to send '${"Popup Load"}' event notification. ${d.message}`)}yield(new $b(a)).initialize();Z.debug("Done.")}())}document.addEventListener("DOMContentLoaded",()=>{Z.trace("Handling DOMContentLoaded...");Hc()});let Ic;null==(Ic=document.querySelector("#templates"))||Ic.addEventListener("mdl-componentupgrading",a=>{Z.info("Handling mdl-componentupgrading...");a.preventDefault()});
